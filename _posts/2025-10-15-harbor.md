---
layout: post
title: Harbor 登录问题解决记录
categories:
  - docker
description: 学一些docker知识
keywords:  
  - docker
  - harbor
mermaid: false
sequence: false
flow: false
mathjax: false
mindmap: false
mindmap2: false
---


---

## 通常执行docker登录harbor的命令


```
docker login  example.com/namespace/registry:tag
```


## 检查项目

Harbor 的配置文件在 `/path/to/your/harbor.yml`。
查看关键字段：

```yaml
hostname: kubernetes-registry.moon.com
http:
  port: 80
https:
  port: 443
  certificate: /data/cert/harbor.crt
  private_key: /data/cert/harbor.key
```

如果 `https:` 块被注释掉或证书文件不存在，那么 Harbor 只启用了 HTTP。
可以在登录是直接指明http, `docker login  http://example/namespace/registry:tag`

---

### 排查daemon.json

> 但是，Docker 默认假设 registry 使用 HTTPS；
> 如果你用 HTTP，必须在客户端 `/etc/docker/daemon.json` 里加上“信任”声明。

编辑：

```json
{
  "insecure-registries": ["kubernetes-registry.moon.com"]
}
```

然后重启 Docker：

```bash
systemctl restart docker
```

再执行登录就能成功
